/*! nanshacity_v2 author:JavieChan create:2016-01-11 updated:2016-07-27 */
function chartAjax(a,b,c){$.ajax({method:"get",url:proUrl+"datamap/device/",data:a,dataType:"json"}).done(function(a){b(a)}).fail(function(a){console.log(a),"function"==typeof c&&c()})}$(function(){var a,b,c,d=[],e=[],f=[],g=[],h=[],i=[],j={optionPie:function(a,b,c){var d={chart:{renderTo:a,type:"pie",options3d:{enabled:!0,alpha:25},backgroundColor:"transparent",style:{color:"#fff"}},title:{text:""},colors:c,credits:{enabled:!1},tooltip:{formatter:function(){return this.key+": "+this.y}},legend:{itemStyle:{fontSize:"16px",fontWeight:"normal"},itemHoverStyle:{fontSize:"16px",fontWeight:"normal"},symbolRadius:6,symbolWidth:12,symbolHeight:12},plotOptions:{pie:{innerSize:100,depth:15,showInLegend:!0,borderWidth:0},series:{dataLabels:{align:"center",color:"#fff",style:{fontSize:"18px",fontWeight:"normal"},format:"{point.y}",distance:10}}},series:[{data:b}]};return d},optionLine:function(a,b){var c={chart:{renderTo:a,type:"spline",backgroundColor:"transparent",spacing:[25,15,5,35]},title:{text:""},xAxis:{allowDecimals:!1,title:{text:"时间",align:"high",style:{color:"#fff",fontSize:"14px"},offset:7,x:10},labels:{style:{color:"#fff",fontSize:"14px"}},tickWidth:0,lineColor:"#fff"},yAxis:{title:{text:"个",align:"high",rotation:0,style:{color:"#fff",fontSize:"14px"},y:-15,offset:15},gridLineWidth:0,tickWidth:0,lineWidth:1,lineColor:"#fff"},credits:{enabled:!1},tooltip:{formatter:function(){return"<b>"+this.x+"点</b><br />"+this.series.name+": "+this.y+"人"}},legend:{itemStyle:{fontSize:"16px",fontWeight:"normal"},itemHoverStyle:{fontSize:"16px",fontWeight:"normal"}},plotOptions:{spline:{marker:{enabled:!1}}},series:b};return c},color:[["#00f6ff","#eb64ff","#e4ff00","#5bff91","#ffeb04"],["#e4ff00","#eb64ff","#5bff91","#ffeb04","#00f6ff"],["#5bff91","#00f6ff","#ffeb04","#eb64ff","#e4ff00"]]},k=!0;$(document).on("click","#changeChart",function(){k?($(this).text("切换饼图"),a=new Highcharts.Chart(j.optionLine("chartA",g)),b=new Highcharts.Chart(j.optionLine("chartB",h)),c=new Highcharts.Chart(j.optionLine("chartC",i)),k=!1):($(this).text("切换坐标"),a=new Highcharts.Chart(j.optionPie("chartA",d,j.color[0])),b=new Highcharts.Chart(j.optionPie("chartB",e,j.color[1])),c=new Highcharts.Chart(j.optionPie("chartC",f,j.color[2])),k=!0)}),$(document).on("click","header span button",function(){$(".block").is(":hidden")?($(this).addClass("on"),$(".block").slideDown(500),chartAjax({location:77201},function(k){if(200==k.code){for(var l="",m="",n=0;n<k.town_ap_rank.length;n++){var o=k.town_ap_rank[n],p="<li><span>"+o[0]+"</span><em>"+o[1]+"</em></li>";l+=p}for(var n=0;n<k.village_ap_rank.length;n++){var o=k.village_ap_rank[n],p="<li><span>"+o[0]+"</span><em>"+o[1]+"</em></li>";m+=p}$("#slimScroll ul:first").append(l),$("#slimScroll ul:last").append(m),$("#slimScroll").slimScroll({height:"178px"}),$(".errInfo em").text(k.offline_count),$(".onlineInfo em").text(k.online_user_count),d=[],e=[],f=[],g=[],h=[],i=[],d.push(["在线",k.online_count],["离线",k.offline_count]),e.push(["空闲=0",k.idle_count],["繁忙>5",k.busy_count],["其他",k.other_count]),f.push(["手机",k.mobile_count],["PC",k.pc_count],["其他终端",k.other_platform_count]),g.push({name:"在线",color:"#00f6ff",data:k.online_chart_data.online},{name:"离线",color:"#eb64ff",data:k.online_chart_data.offline}),h.push({name:"空闲=0",color:"#e4ff00",data:k.conns_chart_data.idle},{name:"繁忙>5",color:"#eb64ff",data:k.conns_chart_data.busy},{name:"其他",color:"#5bff91",data:k.conns_chart_data.other}),i.push({name:"PC",color:"#5bff91",data:k.platform_chart_data.pc},{name:"手机",color:"#00f6ff",data:k.platform_chart_data.mobile},{name:"其他",color:"#ffeb04",data:k.platform_chart_data.other}),a=new Highcharts.Chart(j.optionPie("chartA",d,j.color[0])),b=new Highcharts.Chart(j.optionPie("chartB",e,j.color[1])),c=new Highcharts.Chart(j.optionPie("chartC",f,j.color[2]))}})):($(".block").slideUp(500),$(this).removeClass("on"))}),$(document).on("click",".btngroups button",function(){$(this).addClass("on").siblings().removeClass("on");var a=$(this).index();$("#slimScroll ul").hide(),$("#slimScroll ul").eq(a).show()}),$(document).on("mouseenter","#slimScroll li",function(){$(this).prepend('<i class="clickIco"></i>').siblings().find(".clickIco").remove()}),window.onresize=function(){k&&(a=new Highcharts.Chart(j.optionPie("chartA",d,j.color[0])),b=new Highcharts.Chart(j.optionPie("chartB",e,j.color[1])),c=new Highcharts.Chart(j.optionPie("chartC",f,j.color[2])))},map.on("click",function(a){$(".block").slideUp(500),$("#changeChart").text("切换坐标"),k=!0,$("header span button").removeClass("on")}),$("#mapNav li").on("click",function(){$(this).addClass("on").siblings().removeClass("on");var a=$(this).data("lnglat").split(",");map.getZoom()<13?map.setZoomAndCenter(13,a):map.panTo(a)})});var proUrl="/";
/*! nanshacity_v2 JavieChan */